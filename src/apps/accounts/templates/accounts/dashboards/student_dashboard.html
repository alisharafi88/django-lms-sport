{% load i18n %}
{% load static %}
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{% trans 'Dashboard' %}</title>
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}"/>
    <link rel="stylesheet" href="{% static 'assets/css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/meanmenu.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/animate.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/slick.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/backtotop.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/nice-select.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/ui-icon.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/elegentfonts.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/font-awesome-pro.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/spacing.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/rtl.css' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'assets/img/favicon.png' %}">
    <link rel="stylesheet" href="{% static 'assets/css/student-dashboard.css' %}"/>
</head>
<body>
<!-- Sandwich Icon -->
<div class="sandwich-icon" id="sandwich-icon" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
</div>

<!-- Blur Overlay -->
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <!-- Profile Section -->
    <div class="profile">
        <img src="../Screenshot (12).png"/>
        <div class="name">نام کاربری</div>
    </div>

    <!-- Navigation Buttons -->
    <button class="" style="color: #ff6f64 ;">
        <i class="fas fa-home"></i> بازگشت به صفحه اصلی
    </button>
    <button onclick="navigateToTab('tab1')">
        <i class="fas fa-futbol"></i> تب ۱
    </button>
    <button onclick="navigateToTab('tab2')">
        <i class="fas fa-shopping-cart"></i> {% trans 'Cart' %}
    </button>
    <button onclick="navigateToTab('tab3')">
        <i class="fas fa-cog"></i> تب ۳
    </button>
    <button onclick="navigateToTab('tab4')">
        <i class="fas fa-envelope"></i> تب ۴
    </button>

    <button class="logout" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i> خروج
    </button>
</div>


<div class="content" id="content">

    <div class="element" id="element1">
        <!-- --------------------------------------بخش دوره های من------------------------------------- -->
        <div class="inputs-section">
            <input type="text" class="search-input" placeholder="جست و جو"/>
            <select class="filter-select">
                <option value="" disabled selected>Select an option</option>
                <option value="option1">Option One</option>
                <option value="option2">Option Two</option>
                <option value="option3">Option Three</option>
            </select>
        </div>

        <div class="container">
            <div class="element">
                <div class="image-square" style="background-image:url(../Screenshot\ \(12\).png) ;">
                </div>
                <h2 class="title">Title One</h2>
                <span class="number">1</span>
                <button class="sort-button">Sort</button>
            </div>

            <div class="element">
                <div class="image-square" style="background-image:url(../Screenshot\ \(12\).png) ;"></div>
                <h2 class="title">Title Two</h2>
                <span class="number">2</span>
                <button class="sort-button">Sort</button>
            </div>

            <div class="element">
                <div class="image-square" style="background-image:url(../Screenshot\ \(12\).png) ;"></div>
                <h2 class="title">Title Three</h2>
                <span class="number">3</span>
                <button class="sort-button">Sort</button>
            </div>
        </div>

        <div id="popup-modal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h2>Feedback for Title</h2>

                <div class="star-rating">
                    <input type="radio" id="star5" name="rating" value="5"/>
                    <label for="star5" title="5 stars">&#9733;</label>

                    <input type="radio" id="star4" name="rating" value="4"/>
                    <label for="star4" title="4 stars">&#9733;</label>

                    <input type="radio" id="star3" name="rating" value="3"/>
                    <label for="star3" title="3 stars">&#9733;</label>

                    <input type="radio" id="star2" name="rating" value="2"/>
                    <label for="star2" title="2 stars">&#9733;</label>

                    <input type="radio" id="star1" name="rating" value="1"/>
                    <label for="star1" title="1 star">&#9733;</label>
                </div>

                <textarea
                        id="feedback-text"
                        placeholder="Write your feedback here..."
                ></textarea>

                <button id="submit-feedback" class="modal-button">Submit</button>
            </div>
        </div>
        <!-- ------------------------------------------------------پایان----------------------------------- -->
    </div>

    <!-- ------------------------------------------------------بخش مورد علاقه----------------------------------- -->
    <div class="element" id="element2">
        <!-- Breadcrumb Section -->
        <section class="breadcrumb-section py-4" style="background-color: #f9fafb;">
            <div class="container">
                <div class="row align-items-center">
                    <!-- Breadcrumb Path -->
                    <div class="col-lg-8 col-md-12">
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0 p-0">
                                <li class="breadcrumb-item">
                                    <a href="{% url 'home:home' %}"
                                       class="text-decoration-none text-dark">{% trans 'Home' %}</a>
                                </li>
                                <li class="dvdr"><i class="fa-regular fa-angle-left"></i></li>
                                <li class="active text-muted"
                                    aria-current="page">{% trans 'Cart' %}</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </section>
        <!-- End of Breadcrumb Section -->
        <!-- cart area -->
        <section class="cart-area pt-100 pb-100">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        {% if carts|length %}
                            <div class="table-content table-responsive">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th class="product-thumbnail">{% trans 'Images' %}</th>
                                        <th class="cart-product-name">{% trans 'Courses' %}</th>
                                        <th class="product-price">{% trans 'Unit Price' %}</th>
                                        <th class="product-subtotal">{% trans 'Total' %}</th>
                                        <th class="product-remove">{% trans 'Remove' %}</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for item in carts %}
                                        <tr>
                                            <td class="product-thumbnail"><a
                                                    href="{% url 'courses:course_detail' item.course_obj.id item.course_obj.slug %}"><img
                                                    src="{% static 'assets/img/course/course-thumb-01.jpg' %}"
                                                    alt=""></a>
                                            </td>
                                            <td class="product-name"><a
                                                    href="{% url 'courses:course_detail' item.course_obj.id item.course_obj.slug %}">{{ item.course_obj.title }}</a>
                                            </td>
                                            <td class="product-price"><span
                                                    class="amount">{% trans 'Toman' %}{{ item.course_obj.price }}</span>
                                            </td>
                                            <td class="product-subtotal"><span
                                                    class="amount">{% trans 'Toman' %}{{ item.item_total_price }}</span>
                                            </td>
                                            <td class="product-remove"><a
                                                    href="{% url 'carts:cart_remove' item.course_obj.id %}"><i
                                                    class="fa fa-times"></i></a></td>
                                        </tr>
                                    {% endfor %}

                                    </tbody>
                                </table>

                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="coupon-all">
                                        <div class="coupon">
                                            <input id="coupon_code" class="input-text" name="coupon_code" value=""
                                                   placeholder="Coupon code" type="text">
                                            <button class="tp-btn" name="apply_coupon" type="submit">Apply
                                                coupon
                                            </button>
                                        </div>
                                        <div class="coupon2">
                                            <a href="{% url 'carts:cart_clear' %}">
                                                <button class="tp-btn" type="submit">{% trans 'Clear cart' %}
                                                </button>
                                            </a>
                                            <button class="tp-btn" name="update_cart"
                                                    type="submit">{% trans 'Update cart' %}</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-end">
                                <div class="col-md-5 ">
                                    <div class="cart-page-total">
                                        <h2>Cart totals</h2>
                                        <ul class="mb-20">
                                            <li>{% trans 'Total price' %}
                                                <span>{% trans 'Toman' %}{{ total_price }}</span></li>
                                            <li>{% trans 'Total price after discount' %}
                                                <span>{% trans 'Toman' %}{{ total_discounted_price }}</span></li>
                                        </ul>
                                        <a class="tp-btn"
                                           href="{% url 'orders:order_create' %}">{% trans 'Proceed to checkout' %}% </a>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <div class="col_12">
                                <div class="coupon1">
                                    <p>{% trans 'Your cart is empty!' %}</p>
                                    <a href="{% url 'courses:course_list' %}">
                                        <button class="tp-btn" type="submit">{% trans 'Add course' %}
                                        </button>
                                    </a>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>
        <!-- cart area end-->
    </div>
        <!-- ----------------------------------------------پایان--------------------------- -->
    <div class="element" id="element3">
        <!-- ----------------------------------------------بخش کامنت گزاری--------------------------- -->

        <div class="commentFormContainer">
            <form id="userForm">
                <input type="text" name="firstName" placeholder="First Name"/>
                <input type="text" name="lastName" placeholder="Last Name"/>
                <textarea name="message" placeholder="Your Message"></textarea>
                <button type="submit">Submit</button>
            </form>

            <div id="responses">
                <div class="comment">
                    <img src="" alt="Profile Picture"/>
                    <div class="comment-details">
                        <h4>
                            Alex Johnson <span class="place-name">from New York</span>
                        </h4>
                        <h5>Creative Designer</h5>
                        <p>
                            Absolutely loving the new design trends this year! Minimalism
                            with a splash of color really speaks to me.
                        </p>
                    </div>
                </div>

                <div class="comment">
                    <img src="../Screenshot (12).png" alt="dd "/>
                    <div class="comment-details">
                        <h4>
                            Sophia Martinez <span class="place-name">from London</span>
                        </h4>
                        <h5>Travel Blogger</h5>
                        <p>
                            The hidden cafés along the cobblestone streets are my favorite
                            discoveries. Each one has its own unique charm.
                        </p>
                    </div>
                </div>

                <div class="comment">
                    <img src="" alt="Profile Picture"/>
                    <div class="comment-details">
                        <h4>
                            Liam Chen <span class="place-name">from Singapore</span>
                        </h4>
                        <h5>Food Enthusiast</h5>
                        <p>
                            Just tried the new fusion restaurant downtown—it's a
                            must-visit! The flavors are out of this world.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ------------------------------------------------------پایان----------------------------------- -->

    <div class="element" id="element4">
        <!-- ----------------------------------------------بخش ادیت--------------------------- -->

        <div class="profile-edit-container">
            <form
                    class="profile-form"
                    action="#"
                    method="post"
                    enctype="multipart/form-data"
            >
                <div class="profile-image-section">
                    <img src="../Screenshot (12).png" alt=" profile" id="profileImageDisplay"/>
                    <input
                            type="file"
                            id="profileImageInput"
                            name="profileImage"
                            accept="image/*"
                    />
                    <label for="profileImageInput">Change Profile Picture</label>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="fullName">Full Name</label>
                        <input
                                type="text"
                                id="fullName"
                                name="fullName"
                                placeholder="Enter your full name"
                        />
                    </div>
                    <div class="input-group">
                        <label for="emailAddress">Email Address</label>
                        <input
                                type="email"
                                id="emailAddress"
                                name="emailAddress"
                                placeholder="Enter your email"
                        />
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="phoneNumber">Phone Number</label>
                        <input
                                type="tel"
                                id="phoneNumber"
                                name="phoneNumber"
                                placeholder="Enter your phone number"
                        />
                    </div>
                    <div class="input-group">
                        <label for="location">Location</label>
                        <input
                                type="text"
                                id="location"
                                name="location"
                                placeholder="Enter your location"
                        />
                    </div>
                </div>

                <div class="input-group full-width">
                    <label for="bio">Bio</label>
                    <textarea
                            id="bio"
                            name="bio"
                            placeholder="Tell us about yourself"
                    ></textarea>
                </div>

                <button type="submit">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- ------------------------------------------------------پایان----------------------------------- -->
</div>

<script>
    // Function to navigate between tabs
    function navigateToTab(tab) {
        const elements = document.querySelectorAll(".element");
        elements.forEach((element) => element.classList.remove("active"));
        const sidebar = document.getElementById("sidebar");
        const content = document.getElementById("content");
        const overlay = document.getElementById("overlay");
        sidebar.classList.remove("open");
        content.classList.remove("blur");
        overlay.classList.remove("active");

        // Show the element related to the chosen tab
        if (tab === "main") {
            document.getElementById("element-main").classList.add("active");
        } else {
            document
                .getElementById(`element${tab.replace("tab", "")}`)
                .classList.add("active");
        }

        document
            .querySelectorAll(".sidebar button")
            .forEach((button) => button.classList.remove("active"));
        if (tab === "main") {
            document
                .querySelector(".sidebar button:first-child")
                .classList.add("active");
        } else {
            document
                .querySelector(
                    `.sidebar button:nth-child(${tab.replace("tab", "") + 1})`
                )
                .classList.add("active");
        }
    }

    // Function to toggle sidebar on small screens
    function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const content = document.getElementById("content");
        const overlay = document.getElementById("overlay");
        sidebar.classList.toggle("open");
        content.classList.toggle("blur");
        overlay.classList.toggle("active");
    }

    // Add event listener for responsive toggle
    window.addEventListener("resize", () => {
        if (window.innerWidth <= 768) {
            document.getElementById("sidebar").classList.remove("open");
            document.getElementById("content").classList.remove("blur");
            document.getElementById("overlay").classList.remove("active");
        } else {
            document.getElementById("sidebar").classList.remove("closed");
            document.getElementById("content").classList.remove("blur");
            document.getElementById("overlay").classList.remove("active");
        }
    });


    window.onload = () => {
        if (window.innerWidth <= 768) {
            document.getElementById("sidebar").classList.remove("open");
            document.getElementById("content").classList.remove("blur");
            document.getElementById("overlay").classList.remove("active");
        }
    };

    //--------------------------------------بخش دوره های من--------------------------------------

    const modal = document.getElementById("popup-modal");

    const buttons = document.querySelectorAll(".sort-button");

    const closeBtn = document.querySelector(".close-button");

    buttons.forEach((button) => {
        button.addEventListener("click", () => {
            modal.style.display = "block";
        });
    });

    closeBtn.addEventListener("click", () => {
        modal.style.display = "none";
    });

    window.addEventListener("click", (event) => {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    });

    const submitButton = document.getElementById("submit-feedback");

    submitButton.addEventListener("click", () => {
        const rating = document.querySelector('input[name="rating"]:checked');
        const ratingValue = rating ? rating.value : null;

        const feedbackText = document
            .getElementById("feedback-text")
            .value.trim();

        if (!ratingValue) {
            alert("امتیاز خود را انتخاب کنید");
            return;
        }

        if (feedbackText === "") {
            alert("لطفا نظر خود را وارد کنید.");
            return;
        }

        resetModalForm();

        document.body.classList.remove("modal-open");

        alert("بابت نظرتون متشکریم");
    });

    function resetModalForm() {
        const checkedRating = document.querySelector(
            'input[name="rating"]:checked'
        );
        if (checkedRating) {
            checkedRating.checked = false;
        }

        document.getElementById("feedback-text").value = "";
    }

    buttons.forEach((button) => {
        button.addEventListener("click", (event) => {
            const element = event.target.closest(".element");
            const title = element.querySelector(".title").textContent;

            modal.querySelector("h2").textContent = `Feedback for ${title}`;

            modal.style.display = "block";
            document.body.classList.add("modal-open");
        });
    });
    //------------------------------------------------پایان--------------------------------------

    //------------------------------------------------بخش مورد علاقه ها--------------------------------------

    const likeButtons = document.querySelectorAll(".like-btn");

    likeButtons.forEach((button) => {
        button.addEventListener("click", function () {
            const icon = this.querySelector("i");
            icon.classList.toggle("far");
            icon.classList.toggle("fas");
            this.classList.toggle("liked");
        });
    });

    const starRatings = document.querySelectorAll(".star-rating");

    starRatings.forEach((rating) => {
        const stars = rating.querySelectorAll("i");

        stars.forEach((star) => {
            star.addEventListener("click", function () {
                const ratingValue = parseInt(this.getAttribute("data-rating"));
                stars.forEach((s, index) => {
                    if (index < ratingValue) {
                        s.classList.remove("far");
                        s.classList.add("fas");
                    } else {
                        s.classList.remove("fas");
                        s.classList.add("far");
                    }
                });
            });
        });
    });

    //------------------------------------------------پایان--------------------------------------

    //-------------------------------------------------بخش ادیت-------------------------
    const profileImageInput = document.getElementById("profileImageInput");
    const profileImageDisplay = document.getElementById(
        "profileImageDisplay"
    );

    profileImageInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();

            reader.onload = function (event) {
                profileImageDisplay.setAttribute("src", event.target.result);
            };

            reader.readAsDataURL(file);
        }
    });
    //------------------------------------------------پایان--------------------------------------
</script>
</body>
</html>
